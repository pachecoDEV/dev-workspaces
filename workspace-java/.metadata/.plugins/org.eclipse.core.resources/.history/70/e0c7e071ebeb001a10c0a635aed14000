package br.com.projeto.crud;

import java.sql.Connection;
import java.sql.PreparedStatement;

import br.com.projeto.conexao.Conexao;
import br.com.projeto.nambiquara.dadosVaga;

public class CRUDVagas {
	
	private Connection con;
	private PreparedStatement stmt;
	
	public CRUDVagas() throws Exception {
		con = Conexao.conectar();
	}
	
	public void fechar() throws Exception {
		con.close();
	}
	
	public int add(dadosVaga objeto) throws Exception {
		stmt = con.prepareStatement
				("INSERT INTO TB_PROCESSO"
						+ "(ID_VAGA, DET_VAGA, CURSO, CERTIFICADO, ");
		stmt.setString(1, objeto.);
		stmt.setString(2, objeto.);
		stmt.setString(3, objeto.);
		stmt.setInt(4, objeto.);
		stmt.setString(5, objeto.);
		stmt.setString(6, objeto.);
		stmt.setString(7, objeto.);
		stmt.setInt(8, objeto.);
		
		return stmt.executeUpdate();
	}
	
	public int delete(int id) throws Exception {
		stmt = con.prepareStatement
				("DELETE FROM TB_PROCESSO WHERE ID = ?");
		stmt.setInt(1, id);
		return stmt.executeUpdate();
	}
	
	public int modificaProvPrat(String modProvPrat) throws Exception {
		stmt = con.prepareStatement
				("UPDATE TB_PROCESSO SET ST_PROVPRAT = ST_PROVPRAT WHERE ID = ?");
		stmt.setString(1, modProvPrat);
		return stmt.executeUpdate();
	}

}